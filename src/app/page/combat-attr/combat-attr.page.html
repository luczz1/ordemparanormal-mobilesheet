<ion-content>
  <div class="menu" *ngIf="pageLoaded">
    <ion-row>
      <ion-col size="1" routerLink="/character/{{characterID}}">
        <span style="font-size: 1.3em"
          ><ion-icon name="chevron-back-outline"></ion-icon
        ></span>
      </ion-col>
      <ion-col>
        <span style="font-size: 1.3em">{{charName}}</span>
        <ion-icon name="build-outline" style="float: right"></ion-icon>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col class="ion-margin">
        <span
          style="
            font-size: 1.8em;
            color: var(--ion-color-light-purple);
            -webkit-text-stroke-color: var(--ion-color-purple);
          "
          >Atributos de combate</span
        >
      </ion-col>
    </ion-row>
    <div class="protection-list">
      <div class="shield-item">
        <img src="/assets/image/shield.png" alt="Escudo" />
        <span class="protection-number">
          <input
            type="number"
            (change)="editTotalDefense()"
            [(ngModel)]="totalDefense"
            style="
              width: 25%;
              background: none;
              outline: none;
              text-align: center;
              border: none;
            "
          />
        </span>
      </div>
      <ion-text class="protection-legend" color="medium"
        >= 10 + AGI + Equip + Outros</ion-text
      >
    </div>

    <div class="resistance-list">
      <h3>Resistências</h3>
      <ion-list>
        <ion-item>
          <ion-label>Resistência 1</ion-label>
        </ion-item>
        <ion-item>
          <ion-label>Resistência 2</ion-label>
        </ion-item>
      </ion-list>
    </div>

    <div class="attack-list">
      <h3>
        Ataques
        <ion-text (click)="attacksForm.reset({id: 0, damage: 0}); openStatusModal = true">
          <ion-icon
            style="float: right; font-size: 1.3em"
            name="add-outline"
            color="light"
          >
          </ion-icon>
        </ion-text>
      </h3>
      <ion-list>
        <ion-item *ngFor="let attack of attacksList">
          <ion-label>
            <h4>{{attack.attack_name}} <span
              style="position: absolute; right: 0; margin-right: 1em"
              (click)="deleteAttack(attack.id, attack.attack_name)"
            >
              <ion-icon
                color="danger"
                name="trash-bin-outline"
              ></ion-icon></span>
          </h4>
            <p>Dano: {{attack.damage}}</p>
            <p>Teste:: {{attack.test}}</p>
            <p>
              Crítico, alcance ou especial:
              {{attack.critical_or_range_or_special}}
            </p>
          </ion-label>
        </ion-item>
      </ion-list>
    </div>

    <ion-modal
      [isOpen]="openStatusModal"
      style="--height: 350px; --width: 380px; --border-radius: 40px"
      (willDismiss)="openStatusModal = false;"
    >
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-title>Adicionar ataques</ion-title>
          </ion-toolbar>
        </ion-header>

        <ion-content>
          <form [formGroup]="attacksForm" style="padding: 0.8em">
            <ion-input
              formControlName="attack_name"
              type="text"
              label="Nome"
            ></ion-input>

            <ion-input
              formControlName="test"
              type="text"
              label="Teste"
            ></ion-input>

            <ion-input
              formControlName="damage"
              type="string"
              label="Dano"
            ></ion-input>

            <ion-input
              formControlName="critical_or_range_or_special"
              type="text"
              label="Crítico, alcance ou especial"
            ></ion-input>
          </form>
        </ion-content>

        <ion-footer>
          <ion-toolbar>
            <ion-buttons slot="end">
              <ion-button (click)="addAttacks()">Adicionar</ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-footer>
      </ng-template>
    </ion-modal>
  </div>
</ion-content>
